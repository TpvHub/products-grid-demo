(this["webpackJsonpredux-reselect-immutable-normalizr"]=this["webpackJsonpredux-reselect-immutable-normalizr"]||[]).push([[0],{48:function(e,t,n){e.exports=n(84)},59:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){},81:function(e,t,n){},82:function(e,t,n){},83:function(e,t,n){},84:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"getProducts",(function(){return oe}));var a=n(0),c=n.n(a),o=n(15),u=n.n(o),i=n(8),l=n(36),s=n(17),d=n(2),m=n(24),p=n(37),f=n.n(p),v=n(38),g={token:null,isLoggedIn:!1,role:null},h=n(10),E=["January","February","March","April","May","June","July","August","September","October","November","December"];function b(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.getDate(),a=E[e.getMonth()],c=e.getFullYear(),o=e.getHours(),u=e.getMinutes();return u<10&&(u="0".concat(u)),t?"".concat(t," at ").concat(o,":").concat(u):n?"".concat(r,". ").concat(a," at ").concat(o,":").concat(u):"".concat(r,". ").concat(a," ").concat(c,". at ").concat(o,":").concat(u)}var O=function(e){if(!e)return null;var t="object"===typeof e?e:new Date(e),n=new Date,r=new Date(n-864e5),a=Math.round((n-t)/1e3),c=Math.round(a/60),o=n.toDateString()===t.toDateString(),u=r.toDateString()===t.toDateString(),i=n.getFullYear()===t.getFullYear();return a<5?"now":a<60?"".concat(a," seconds ago"):a<90?"about a minute ago":c<60?"".concat(c," minutes ago"):o?b(t,"Today"):u?b(t,"Yesterday"):i?b(t,!1,!0):b(t)};var j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return(e=isNaN(+e)?0:+e).toFixed(t).replace(/\d(?=(\d{3})+\.)/g,"$&,")},_=function(e){return"[object Function]"===Object.prototype.toString.call(e)},y=function(e){return e},S=function(e){return e},P=function(e){return function(t){return"".concat(e,".").concat(t)}},T=function(e){return"".concat(e,"_PENDING")},A=function(e){return"".concat(e,"_SUCCESS")},C=function(e){return"".concat(e,"_FAILURE")},I=function(e){return{type:T(e)}},N=function(e,t){return{type:A(e),payload:t}},D=function(e,t){return{type:C(e),payload:t}},w=P("products")("FETCH_PRODUCTS"),F=P("products")("UPDATE_META"),R=P("products")("CLEAN_PRODUCTS"),k=function(e,t){switch(t.type){case A(w):return Object(h.d)(e,Object(h.b)({byId:t.payload.entities.products,allIds:Object.keys(t.payload.entities.products)}));default:return e}},L=function(e,t){switch(t.type){case T(w):return e.setIn(["isFetching"],!0);case A(w):return e=(e=(e=e.setIn(["isFetching"],!1)).updateIn(["result"],(function(e){return e.concat(t.payload.result)}))).setIn(["meta","isLastPage"],0===t.payload.result.length);case C(w):return e.setIn(["isFetching"],!1);case F:return e.setIn(["meta"],t.payload);case R:return e.setIn(["result"],Object(h.a)());default:return e}},M=Object(h.b)({entities:{byId:{},allIds:[]},productsGrid:{meta:{page:1,limit:16,sort:"id",isLastPage:!1},isFetching:!1,result:[]}}),U=Object(d.c)({entities:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M.get("entities"),t=arguments.length>1?arguments[1]:void 0;return k(e,t)},productsGrid:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:M.get("productsGrid"),t=arguments.length>1?arguments[1]:void 0;return L(e,t)}}),z=Object(d.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;return t.type,e},products:U}),B={key:"redux-reselect-immutable-normalizr",storage:f.a,whitelist:["auth"]},H=Object(m.a)(B,z),G=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||d.d,x=void 0!==Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_API_URL:""}).REACT_APP_BASE_PATH?Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_API_URL:""}).REACT_APP_BASE_PATH:"",W=n(12),J=n(18),K=n(13);function Y(e){return function(t){var n=Object.entries(t).reduce((function(e,t){var n=Object(K.a)(t,2),r=n[0],a=n[1];return Object(h.c)(a)?e[r]=a.toJS():e[r]=a,e}),{});return c.a.createElement(e,n)}}n(59);function V(e){var t=e.product;return c.a.createElement("div",{className:"product"},c.a.createElement("div",{className:"face"},c.a.createElement("span",{style:{fontSize:t.size+"px"}},t.face)),c.a.createElement("div",null,c.a.createElement("b",null,"Price:")," ",c.a.createElement("span",{className:"price"},"$",j(t.price))),c.a.createElement("div",null,c.a.createElement("b",null,"Size:")," ",t.size),c.a.createElement("div",null,c.a.createElement("b",null,"Date:")," ",O(t.date)),c.a.createElement("button",{className:"buy"},"Add to card"))}var $=n(39),X=n(40),q=Object(X.a)((function(e){return e.products.entities.get("byId")}),(function(e){return e.products.productsGrid.get("result")}),(function(e,t){return t.map((function(t){return e.get(String(t)).toJS()}))})),Q=n(19),Z=n(41),ee=n.n(Z),te=n(86),ne=function(e){return Promise.resolve(e)},re=function(e){return Promise.reject(e.response)},ae=function(){var e,t=(e=De.getState(),Object(te.a)(null,["auth","token"],e)),n=ee.a.create({baseURL:"",headers:t?{Authorization:"Token ".concat(t)}:{}});return{get:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.get(e,{params:t},r).then(ne).catch(re)},post:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.post(e,t,r).then(ne).catch(re)},put:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.put(e,t,r).then(ne).catch(re)},delete:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.delete(e,t).then(ne).catch(re)}}},ce={page:1,limit:20},oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,t=e.page,n=e.limit,r=e.sort;return ae().get("/products?_page=".concat(t,"&_limit=").concat(n,"&_sort=").concat(r)).then((function(e){return e.data}))},ue=r,ie=new Q.b.Entity("products"),le=new Q.b.Array(ie),se=function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:S;return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(c,o){var u=_(a)?a(o):a;return c(I(e)),t(u).then((function(t){var r=n(t);return c(N(e,r)),Promise.resolve(r)})).catch((function(t){var n=r(t);return c(D(e,n)),Promise.reject(n)}))}}}(w,ue.getProducts,(function(e){var t=Object(Q.a)(e,le);return{entities:{products:t.entities.products||[]},result:t.result||[]}}))(e)},de=function(e){return{type:F,payload:e}},me=n(42),pe=n(43),fe=n(46),ve=n(44),ge=n(47),he=function(e){function t(e){var n;return Object(me.a)(this,t),(n=Object(fe.a)(this,Object(ve.a)(t).call(this,e))).state={isAllowEnter:!1,urlRedirect:null},n}return Object(ge.a)(t,e),Object(pe.a)(t,[{key:"componentDidMount",value:function(){var e=this;Promise.all(this.props.middlewares.map((function(t){return t(e.props.store)}))).then((function(){e.setState({isAllowEnter:!0})})).catch((function(t){e.setState({urlRedirect:t})}))}},{key:"render",value:function(){var e=this.props,t=e.path,n=e.component,r=this.state,a=r.urlRedirect,o=r.isAllowEnter;return c.a.createElement(W.b,{path:t,render:function(e){return o?c.a.createElement(n,e):null===a?null:c.a.createElement(W.a,{to:a})}})}}]),t}(c.a.Component);he.defaultProps={middlewares:[],store:{},component:c.a.createElement("div",null)};Object(i.b)((function(e){return{store:e}}),{})(he),n(78);function Ee(){return c.a.createElement("div",{className:"spinner"})}n(79);var be=c.a.memo((function(e){var t=e.parentId,n=e.loading,r=e.onFetchMore,o=e.shouldFetchMore,u=e.stopBanner,i=Object(a.useState)(!1),l=Object(K.a)(i,2),s=l[0],d=l[1],m=Object(a.useCallback)((function(){d(!0),r((function(){setTimeout((function(){d(!1)}),500)}))}),[r]),p=Object(a.useCallback)((function(){var e=document.getElementById(t);e.scrollHeight-e.scrollTop-e.clientHeight<1&&!1===s&&o&&m()}),[s,o,m,t]);return Object(a.useEffect)((function(){var e=document.getElementById(t);return e.addEventListener("scroll",p),function(){e.removeEventListener("scroll",p)}}),[p,t]),c.a.createElement("div",{className:"fetcher"},s?n||c.a.createElement("div",null,"Loading more ..."):null,!o&&c.a.createElement("div",null,u||"~ end of catalogue ~"))}));n(80);var Oe=Object(d.d)(Object(i.b)((function(e){return{isFetching:e.products.productsGrid.get("isFetching"),products:q(e),meta:e.products.productsGrid.get("meta")}}),{}),Y)((function(e){var t=e.meta,n=e.products,r=(e.entities,Object($.a)(e,["meta","products","entities"])),o=Object(i.c)(),u=Object(a.useCallback)((function(e){var n=Object(J.a)({},t,{page:t.page+1});o(de(n)),o(se(n)).then((function(){e()}))}),[o,t]);return c.a.createElement("div",{className:"products-grid",id:"products-grid"},r.isFetching&&0===n.length&&c.a.createElement("div",null,c.a.createElement(Ee,null)),n.map((function(e,t){return c.a.createElement(V,{key:t,product:e})})),c.a.createElement(be,{loading:c.a.createElement(Ee,null),shouldFetchMore:!t.isLastPage,parentId:"products-grid",onFetchMore:u}))}));n(81);var je=c.a.memo((function(e){var t=e.totalProducts,n=e.meta,r=e.handleChangeSortType,o=Object(a.useCallback)((function(e){r(e.target.value)}),[r]);return c.a.createElement("div",{className:"products-grid-header"},c.a.createElement("div",{className:"total"},t," Product(s) found."),c.a.createElement("div",{className:"sort"},c.a.createElement("span",null,"Order by"),c.a.createElement("select",{placeholder:"select order by",name:"select_filter",id:"select_filter",value:n.sort,onChange:o},c.a.createElement("option",{value:"id"},"Id"),c.a.createElement("option",{value:"size"},"Size"),c.a.createElement("option",{value:"price"},"Price"))))}));var _e={fetchProduct:se},ye=Object(d.d)(Object(i.b)((function(e){return{meta:e.products.productsGrid.get("meta"),total:e.products.productsGrid.get("result").size}}),_e),Y)((function(e){var t=e.meta,n=e.total,r=Object(i.c)(),o=Object(a.useRef)(t);Object(a.useEffect)((function(){r(se(o.current))}),[r,o]);var u=Object(a.useCallback)((function(e){var t=Object(J.a)({},o.current,{sort:e});o.current=t,r(de(t)),r({type:R}),r(se(o.current))}),[r]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(je,{totalProducts:n,meta:t,handleChangeSortType:u}),c.a.createElement(Oe,null))})),Se=function(){return Math.floor(1e3*Math.random())};var Pe=function(){var e=Object(a.useState)(Se()),t=Object(K.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){var e=setInterval((function(){r(Se())}),2e4);return function(){clearInterval(e)}}),[]),c.a.createElement("header",null,c.a.createElement("h1",null,"Products Grid"),c.a.createElement("p",null,"Here you're sure to find a bargain on some of the finest ascii available to purchase. Be sure to peruse our selection of ascii faces in an exciting range of sizes and prices."),c.a.createElement("p",null,"But first, a word from our sponsors:")," ",c.a.createElement("img",{class:"ad",src:"http://localhost:3001/ads/?r=".concat(n)}))};n(82);var Te=function(){return c.a.createElement("div",{className:"App"},c.a.createElement(Pe,null),c.a.createElement(ye,null))};function Ae(){return c.a.createElement("div",{className:"not-found"},c.a.createElement("h1",null,"NOT FOUND"))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(83);n.d(t,"_store",(function(){return De}));var Ce=function(){var e=Object(d.e)(H,G(Object(d.a)(v.a)));return{store:e,persistor:Object(m.b)(e)}}(),Ie=Ce.store,Ne=Ce.persistor,De=Ie;u.a.render(c.a.createElement(i.a,{store:Ie},c.a.createElement(l.a,{loading:"loading",persistor:Ne},c.a.createElement(s.a,{basename:x},c.a.createElement((function(){return c.a.createElement("div",{className:"Root-App"},c.a.createElement(W.d,null,c.a.createElement(W.b,{exact:!0,path:["/","/home"],component:Te}),c.a.createElement(W.b,{component:Ae})))}),null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[48,1,2]]]);