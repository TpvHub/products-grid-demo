(this["webpackJsonpredux-reselect-immutable-normalizr"]=this["webpackJsonpredux-reselect-immutable-normalizr"]||[]).push([[0],{48:function(e,t,n){e.exports=n(84)},59:function(e,t,n){},78:function(e,t,n){},79:function(e,t,n){},80:function(e,t,n){},81:function(e,t,n){},82:function(e,t,n){},83:function(e,t,n){},84:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"getProducts",(function(){return ie}));var a=n(0),c=n.n(a),o=n(14),u=n.n(o),i=n(6),l=n(36),s=n(16),d=n(2),m=n(24),p=n(37),f=n.n(p),v=n(38),g={token:null,isLoggedIn:!1,role:null},h=n(10),E=["January","February","March","April","May","June","July","August","September","October","November","December"];function b(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.getDate(),a=E[e.getMonth()],c=e.getFullYear(),o=e.getHours(),u=e.getMinutes();return u<10&&(u="0".concat(u)),t?"".concat(t," at ").concat(o,":").concat(u):n?"".concat(r,". ").concat(a," at ").concat(o,":").concat(u):"".concat(r,". ").concat(a," ").concat(c,". at ").concat(o,":").concat(u)}var O=function(e){if(!e)return null;var t="object"===typeof e?e:new Date(e),n=new Date,r=new Date(n-864e5),a=Math.round((n-t)/1e3),c=Math.round(a/60),o=n.toDateString()===t.toDateString(),u=r.toDateString()===t.toDateString(),i=n.getFullYear()===t.getFullYear();return a<5?"now":a<60?"".concat(a," seconds ago"):a<90?"about a minute ago":c<60?"".concat(c," minutes ago"):o?b(t,"Today"):u?b(t,"Yesterday"):i?b(t,!1,!0):b(t)};var _=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return(e=isNaN(+e)?0:+e).toFixed(t).replace(/\d(?=(\d{3})+\.)/g,"$&,")},j=function(e){return"[object Function]"===Object.prototype.toString.call(e)},y=function(e){return e},P=function(e){return e},S=function(e){return function(t){return"".concat(e,".").concat(t)}},A=function(e){return"".concat(e,"_PENDING")},R=function(e){return"".concat(e,"_SUCCESS")},T=function(e){return"".concat(e,"_FAILURE")},C=function(e){return{type:A(e)}},N=function(e,t){return{type:R(e),payload:t}},D=function(e,t){return{type:T(e),payload:t}},I=S("products")("FETCH_PRODUCTS"),w=S("products")("UPDATE_META"),F=S("products")("CLEAN_PRODUCTS"),L=S("products")("CHANGE_ADS"),M=function(e,t){switch(t.type){case R(I):return Object(h.d)(e,Object(h.b)({byId:t.payload.entities.products,allIds:Object.keys(t.payload.entities.products)}));default:return e}},k=null,U=function(e,t){switch(t.type){case A(I):return e.setIn(["isFetching"],!0);case R(I):return e=(e=(e=e.setIn(["isFetching"],!1)).updateIn(["result"],(function(e){return e.concat(t.payload.result)}))).setIn(["meta","isLastPage"],0===t.payload.result.length);case T(I):return e.setIn(["isFetching"],!1);case w:return e.setIn(["meta"],t.payload);case F:return e.setIn(["result"],Object(h.a)());case L:k=e.get("adsRandom");var n=null;return function e(){n=Math.floor(1e3*Math.random()),k===n&&e()}(),e.setIn(["adsRandom"],n);default:return e}},z=Object(h.b)({entities:{byId:{},allIds:[]},productsGrid:{meta:{page:1,limit:20,sort:"id",isLastPage:!1},isFetching:!1,result:[],adsRandom:Math.floor(1e3*Math.random())}}),G=Object(d.c)({entities:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z.get("entities"),t=arguments.length>1?arguments[1]:void 0;return M(e,t)},productsGrid:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:z.get("productsGrid"),t=arguments.length>1?arguments[1]:void 0;return U(e,t)}}),H=Object(d.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;return t.type,e},products:G}),B={key:"redux-reselect-immutable-normalizr",storage:f.a,whitelist:["auth"]},x=Object(m.a)(B,H),W=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||d.d,J=void 0!==Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_SERVER_URL:"",REACT_APP_API_URL:""}).REACT_APP_BASE_PATH?Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_SERVER_URL:"",REACT_APP_API_URL:""}).REACT_APP_BASE_PATH:"",K=n(12),V=n(18),Y=n(17);function $(e){return function(t){var n=Object.entries(t).reduce((function(e,t){var n=Object(Y.a)(t,2),r=n[0],a=n[1];return Object(h.c)(a)?e[r]=a.toJS():e[r]=a,e}),{});return c.a.createElement(e,n)}}n(59);function X(e){var t=e.product;return c.a.createElement("div",{className:"product"},c.a.createElement("div",{className:"face"},c.a.createElement("span",{style:{fontSize:t.size+"px"}},t.face)),c.a.createElement("div",null,c.a.createElement("b",null,"Price:")," ",c.a.createElement("span",{className:"price"},"$",_(t.price))),c.a.createElement("div",null,c.a.createElement("b",null,"Size:")," ",t.size),c.a.createElement("div",null,c.a.createElement("b",null,"Date:")," ",O(t.date)),c.a.createElement("button",{className:"buy"},"Add to card"))}var q=n(39),Q=n(40),Z=Object(Q.a)((function(e){return e.products.entities.get("byId")}),(function(e){return e.products.productsGrid.get("result")}),(function(e,t){return t.map((function(t){return e.get(String(t)).toJS()}))})),ee=n(19),te=n(41),ne=n.n(te),re=n(86),ae=function(e){return Promise.resolve(e)},ce=function(e){return Promise.reject(e.response)},oe=function(){var e,t=(e=Ie.getState(),Object(re.a)(null,["auth","token"],e)),n=ne.a.create({baseURL:"",headers:t?{Authorization:"Token ".concat(t)}:{}});return{get:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.get(e,{params:t},r).then(ae).catch(ce)},post:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.post(e,t,r).then(ae).catch(ce)},put:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return n.put(e,t,r).then(ae).catch(ce)},delete:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.delete(e,t).then(ae).catch(ce)}}},ue={page:1,limit:20},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue,t=e.page,n=e.limit,r=e.sort;return oe().get("/products?_page=".concat(t,"&_limit=").concat(n,"&_sort=").concat(r)).then((function(e){return e.data}))},le=r,se=new ee.b.Entity("products"),de=new ee.b.Array(se),me=function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:y,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:P;return function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(c,o){var u=j(a)?a(o):a;return c(C(e)),t(u).then((function(t){var r=n(t);return c(N(e,r)),Promise.resolve(r)})).catch((function(t){var n=r(t);return c(D(e,n)),Promise.reject(n)}))}}}(I,le.getProducts,(function(e){var t=Object(ee.a)(e,de);return{entities:{products:t.entities.products||[]},result:t.result||[]}}))(e)},pe=function(e){return{type:w,payload:e}},fe=n(42),ve=n(43),ge=n(46),he=n(44),Ee=n(47),be=function(e){function t(e){var n;return Object(fe.a)(this,t),(n=Object(ge.a)(this,Object(he.a)(t).call(this,e))).state={isAllowEnter:!1,urlRedirect:null},n}return Object(Ee.a)(t,e),Object(ve.a)(t,[{key:"componentDidMount",value:function(){var e=this;Promise.all(this.props.middlewares.map((function(t){return t(e.props.store)}))).then((function(){e.setState({isAllowEnter:!0})})).catch((function(t){e.setState({urlRedirect:t})}))}},{key:"render",value:function(){var e=this.props,t=e.path,n=e.component,r=this.state,a=r.urlRedirect,o=r.isAllowEnter;return c.a.createElement(K.b,{path:t,render:function(e){return o?c.a.createElement(n,e):null===a?null:c.a.createElement(K.a,{to:a})}})}}]),t}(c.a.Component);be.defaultProps={middlewares:[],store:{},component:c.a.createElement("div",null)};Object(i.b)((function(e){return{store:e}}),{})(be),n(78);function Oe(){return c.a.createElement("div",{className:"spinner"})}n(79);var _e=c.a.memo((function(e){var t=e.parentId,n=e.loading,r=e.onFetchMore,o=e.shouldFetchMore,u=e.stopBanner,i=Object(a.useState)(!1),l=Object(Y.a)(i,2),s=l[0],d=l[1],m=Object(a.useCallback)((function(){d(!0),r((function(){setTimeout((function(){d(!1)}),500)}))}),[r]),p=Object(a.useCallback)((function(){var e=document.getElementById(t);e.scrollHeight-e.scrollTop-e.clientHeight<1&&!1===s&&o&&m()}),[s,o,m,t]);return Object(a.useEffect)((function(){var e=document.getElementById(t);return e.addEventListener("scroll",p),function(){e.removeEventListener("scroll",p)}}),[p,t]),c.a.createElement("div",{className:"fetcher"},s?n||c.a.createElement("div",null,"Loading more ..."):null,!o&&c.a.createElement("div",null,u||"~ end of catalogue ~"))}));n(80);var je=Object(d.d)(Object(i.b)((function(e){return{isFetching:e.products.productsGrid.get("isFetching"),products:Z(e),meta:e.products.productsGrid.get("meta")}}),{}),$)((function(e){var t=e.meta,n=e.products,r=(e.entities,Object(q.a)(e,["meta","products","entities"])),o=Object(i.c)(),u=Object(a.useCallback)((function(e){var n=Object(V.a)({},t,{page:t.page+1});o(pe(n)),o(me(n)).then((function(){o({type:L,payload:Math.floor(1e3*Math.random())}),e()}))}),[o,t]);return c.a.createElement("div",{className:"products-grid",id:"products-grid"},r.isFetching&&0===n.length&&c.a.createElement("div",null,c.a.createElement(Oe,null)),n.map((function(e,t){return c.a.createElement(X,{key:t,product:e})})),c.a.createElement(_e,{loading:c.a.createElement(Oe,null),shouldFetchMore:!t.isLastPage,parentId:"products-grid",onFetchMore:u}))}));n(81);var ye=c.a.memo((function(e){var t=e.totalProducts,n=e.meta,r=e.handleChangeSortType,o=Object(a.useCallback)((function(e){r(e.target.value)}),[r]);return c.a.createElement("div",{className:"products-grid-header"},c.a.createElement("div",{className:"total"},t," Product(s) found."),c.a.createElement("div",{className:"sort"},c.a.createElement("span",null,"Order by"),c.a.createElement("select",{placeholder:"select order by",name:"select_filter",id:"select_filter",value:n.sort,onChange:o},c.a.createElement("option",{value:"id"},"Id"),c.a.createElement("option",{value:"size"},"Size"),c.a.createElement("option",{value:"price"},"Price"))))}));var Pe={fetchProduct:me},Se=Object(d.d)(Object(i.b)((function(e){return{meta:e.products.productsGrid.get("meta"),total:e.products.productsGrid.get("result").size}}),Pe),$)((function(e){var t=e.meta,n=e.total,r=Object(i.c)(),o=Object(a.useRef)(t);Object(a.useEffect)((function(){r(me(o.current))}),[r,o]);var u=Object(a.useCallback)((function(e){var t=Object(V.a)({},o.current,{sort:e});o.current=t,r(pe(t)),r({type:F}),r(me(o.current))}),[r]);return c.a.createElement(c.a.Fragment,null,c.a.createElement(ye,{totalProducts:n,meta:t,handleChangeSortType:u}),c.a.createElement(je,null))}));var Ae=Object(i.b)((function(e){return{adsRandom:e.products.productsGrid.get("adsRandom")}}))((function(e){var t=e.adsRandom;return c.a.createElement("header",null,c.a.createElement("h1",null,"Products Grid"),c.a.createElement("p",null,"Here you're sure to find a bargain on some of the finest ascii available to purchase. Be sure to peruse our selection of ascii faces in an exciting range of sizes and prices."),c.a.createElement("p",null,"But first, a word from our sponsors:")," ",c.a.createElement("img",{className:"ad",src:"".concat("","/ads/?r=").concat(t)}))}));n(82);var Re=function(){return c.a.createElement("div",{className:"App"},c.a.createElement(Ae,null),c.a.createElement(Se,null))};function Te(){return c.a.createElement("div",{className:"not-found"},c.a.createElement("h1",null,"NOT FOUND"))}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(83);n.d(t,"_store",(function(){return Ie}));var Ce=function(){var e=Object(d.e)(x,W(Object(d.a)(v.a)));return{store:e,persistor:Object(m.b)(e)}}(),Ne=Ce.store,De=Ce.persistor,Ie=Ne;u.a.render(c.a.createElement(i.a,{store:Ne},c.a.createElement(l.a,{loading:"loading",persistor:De},c.a.createElement(s.a,{basename:J},c.a.createElement((function(){return c.a.createElement("div",{className:"Root-App"},c.a.createElement(K.d,null,c.a.createElement(K.b,{exact:!0,path:["/","/home"],component:Re}),c.a.createElement(K.b,{component:Te})))}),null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[48,1,2]]]);